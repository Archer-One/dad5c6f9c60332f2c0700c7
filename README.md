# Abasract

Payment Channel Hubs (PCHs) are a promising approach to scaling blockchain throughput by enabling off-chain payments through a semi-trusted intermediary. However, existing PCH designs face a fundamental tension among privacy, efficiency, and functionality, particularly when supporting bidirectional channels with variable payment amounts. For instance, $\mathtt{BlindHub}$ (S\&P 2023) provides amount confidentiality but is susceptible to payer-payee linkage via abort attacks and depends on costly garbled-circuit-based zero-knowledge proofs (ZKPs). In contrast, $\mathtt{Accio}$ (CCS 2023) improves performance by eliminating ZKPs at the cost of revealing payment amounts and restricting channels to be unidirectional.

We present $\PBHub$, a privacy-preserving PCH that simultaneously supports bidirectional payment channels and confidential variable-amount payments without incurring prohibitive overhead. The key insight behind $\PBHub$ is a channel-state-based PCH design combined with a new cryptographic primitive, the rerandomizable evolving state signature, which enables the hub to verify payment correctness with a single lightweight ZKP per payment, such as Bulletproofs. We formally prove that $\PBHub$ achieves security and privacy guarantees in the Universal Composability framework. Our comprehensive evaluation demonstrates that, in typical bidirectional payment scenarios, $\PBHub$ reduces on-chain gas costs by more than $5.8\times$ compared to $\mathtt{Accio}$. Furthermore, it significantly enhances off-chain payment efficiency, outperforming $\mathtt{BlindHub}$ and $\mathtt{Accio}$ by approximately $68\times$ and $4.6\times$ respectively.
